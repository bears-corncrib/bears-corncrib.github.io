<!DOCTYPE html>
<html lang="zh_cn">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Tao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="git, Bear's Corncobs, " />

<meta property="og:title" content="Does git need a Staging Area? "/>
<meta property="og:url" content="/Does git need a Staging Area.html" />
<meta property="og:description" content="There is Staging Area in git, while I found that git can be learned easier if I just ignore Staging Area. Those massive commands seems tidy without caring about Staging Area. let&#39;s see how it works." />
<meta property="og:site_name" content="Tester&#39;s Tricks" />
<meta property="og:article:author" content="Tao" />
<meta property="og:article:published_time" content="2019-07-10T10:00:00+08:00" />
<meta property="og:article:modified_time" content="2019-07-15T00:00:00+08:00" />
<meta name="twitter:title" content="Does git need a Staging Area? ">
<meta name="twitter:description" content="There is Staging Area in git, while I found that git can be learned easier if I just ignore Staging Area. Those massive commands seems tidy without caring about Staging Area. let&#39;s see how it works.">

        <title>Does git need a Staging Area?  Â· Tester&#39;s Tricks
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">



    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="/"><span class=site-name>Tester's Tricks</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="">Home</a></li>
                            <li ><a href="/categories">Categories</a></li>
                            <li ><a href="/tags">Tags</a></li>
                            <li ><a href="/archives">Archives</a></li>
                            <li><form class="navbar-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="/Does git need a Staging Area.html"> Does git need a Staging Area?  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <h1>What is git</h1>
<p>git is so wildly used. It is verbose to explain here. Check it out <a href="https://git-scm.com/about">here</a>. </p>
<p>No one will be here without any knowledge about git.</p>
<h1>Moving around Areas</h1>
<p>There are a few areas in git. Working Area, Local Repository, Remote Repository are all strait-forward concept. 
Here is a basic issuestration about these areas. This picture is not my work, but from goole search.</p>
<p><img alt="Baisc Areas about git" src="./pictures/Areas of git.jpg"></p>
<p>We can move files around by these commands below. Read along line records, not vertical based.</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Working Area (WA)</th>
<th align="left">Local Repository(LR)</th>
<th align="left">Remote Repository(RR)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Working Area</td>
<td align="left">git add</td>
<td align="left">git commit</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Local Repository</td>
<td align="left">git checkout HEAD; git merge</td>
<td align="left">git branch;git reset</td>
<td align="left">git push</td>
</tr>
<tr>
<td align="left">Remote Repository</td>
<td align="left">git pull,git clone</td>
<td align="left">git fetch</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>Staging Area (SA) is also called Index, or Cache. Index, means a funiton that points and identifies some record; while cache means a funtion of temporary storing. 
<a href="https://git-scm.com/about/staging-area">Staging Area</a> confuzed me before I seperatly understand index and cache function.</p>
<ul>
<li>Why I can't put something only in SA and get it back to WA, before <code>git commit</code></li>
<li>Why <code>git checkout</code> means from SA, <code>git checkout HEAD</code> means from LR</li>
</ul>
<p>Let's just take the funiton of indexing and ignor the funiont of caching here. git is simplifed into 3 areas.</p>
<p><code>git add</code> is considered to add files into tracking here. (It actually moves files to Staging Area, which we will discuss later.)</p>
<h1>Local Repository (LR)</h1>
<p>When I forget the curiosity about what is store in Staging Area, but take it as a pointer. A lot of operation become reasonable.</p>
<ul>
<li><code>git add</code> means start tracking file by git, but not add the file to SA</li>
<li><code>git commit</code> means to send files to LR and move the pointer to the latest one as HEAD in this branch.</li>
<li><code>git reset</code> means to move the pointer to a specific position/historical commit. </li>
<li><code>git checkout</code> means to override files, which pointer currenlty points, from LA. <code>git checkout HEAD</code> means to move the pointer to HEAD and check it out to WA.</li>
</ul>
<h1>How to move the index/pointer</h1>
<p>There are two concepts about LA, Branches and commits. Here below, it illustrate them as a metrix.</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">SHA-1</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">SHA-1</td>
<td align="left">SHA-1</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">HEAD</td>
<td align="left">SHA-1</td>
<td align="left">SHA-1</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">HEAD</td>
<td align="left">SHA-1</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">HEAD</td>
</tr>
</tbody>
</table>
<p>git index every single commits by a SHA-1 hash. They can be checked by <code>git log</code>. The most latest one is named HEAD. </p>
<p>It is not necessary to identify your index/pointer by the full lengh of hash. Pointer can be used only if you take more than 4 digits from right and there is no ambiguity. <code>git log --oneline</code> give clear and useful index.</p>
<p>There can be a few braches, which either is built by <code>git branch</code> or <code>git fetch</code> from an unrelated RR. The very first branch is named master.</p>
<p>Here is an planground that we can test moving index abount LR.</p>
<h3>Making a WA</h3>
<div class="highlight"><pre><span></span><code>$ mkdir gitTest
$ <span class="nb">cd</span> gitTest
$ git init
Initialized empty Git repository in /private/tmp/gitTest/.git/
</code></pre></div>


<h3>Making a commit</h3>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;111&quot;</span> &gt;&gt;t1.text
$ ls
t1.text
$ git add .
$ git commit -m <span class="s2">&quot;1 in master&quot;</span>
<span class="o">[</span>master <span class="o">(</span>root-commit<span class="o">)</span> 56b1732<span class="o">]</span> <span class="m">1</span> in master
 <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>
 create mode <span class="m">100644</span> t1.text
$ git log
commit 56b17322d958b06c4116e763b9940c14c8fa3a50 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span>
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Sun Jul <span class="m">14</span> <span class="m">12</span>:42:35 <span class="m">2019</span> +0800

    <span class="m">1</span> in master
$ git log --oneline
56b1732 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732 (HEAD -&gt; master)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>Making another commit</h3>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;222&quot;</span> &gt;&gt;t1.text
$ git commit -m <span class="s2">&quot;2 in master&quot;</span> -a
<span class="o">[</span>master 41e433e<span class="o">]</span> <span class="m">2</span> in master
 <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>
$ git log
commit 41e433e9544a4807435786115d94fd7a2e0220c0 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span>
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Sun Jul <span class="m">14</span> <span class="m">12</span>:46:20 <span class="m">2019</span> +0800

    <span class="m">2</span> in master

commit 56b17322d958b06c4116e763b9940c14c8fa3a50
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Sun Jul <span class="m">14</span> <span class="m">12</span>:42:35 <span class="m">2019</span> +0800

    <span class="m">1</span> in master
$ git log --oneline
41e433e <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>Making a brach</h3>
<div class="highlight"><pre><span></span><code>$ git branch new1
$ git branch
* master
  new1
$ git checkout new1
Switched to branch <span class="s1">&#39;new1&#39;</span>
$ git branch
  master
* new1
$ git log
commit 41e433e9544a4807435786115d94fd7a2e0220c0 <span class="o">(</span>HEAD -&gt; new1, master<span class="o">)</span>
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Sun Jul <span class="m">14</span> <span class="m">12</span>:46:20 <span class="m">2019</span> +0800

    <span class="m">2</span> in master

commit 56b17322d958b06c4116e763b9940c14c8fa3a50
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Sun Jul <span class="m">14</span> <span class="m">12</span>:42:35 <span class="m">2019</span> +0800

    <span class="m">1</span> in master
$ git log --oneline
41e433e <span class="o">(</span>HEAD -&gt; new1, master<span class="o">)</span> <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>Keep working in new brach</h3>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="n">echo</span> <span class="s">&quot;333&quot;</span> <span class="o">&gt;&gt;</span><span class="n">t1</span><span class="p">.</span><span class="n">text</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s">&quot;3 in new1&quot;</span> <span class="o">-</span><span class="n">a</span>
<span class="p">[</span><span class="n">new1</span> <span class="n">fa1cd19</span><span class="p">]</span> <span class="mi">3</span> <span class="k">in</span> <span class="n">new1</span>
 <span class="mi">1</span> <span class="n">file</span> <span class="n">changed</span><span class="p">,</span> <span class="mi">1</span> <span class="n">insertion</span><span class="p">(</span><span class="o">+</span><span class="p">)</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="n">oneline</span>
<span class="n">fa1cd19</span> <span class="p">(</span><span class="n">HEAD</span> <span class="o">-&gt;</span> <span class="n">new1</span><span class="p">)</span> <span class="mi">3</span> <span class="k">in</span> <span class="n">new1</span>
<span class="mf">41e433</span><span class="n">e</span> <span class="p">(</span><span class="n">master</span><span class="p">)</span> <span class="mi">2</span> <span class="k">in</span> <span class="n">master</span>
<span class="mi">56</span><span class="n">b1732</span> <span class="mi">1</span> <span class="k">in</span> <span class="n">master</span>
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left">41e433e</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">fa1cd19 (HEAD -&gt; new1)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>Go back to historical file</h3>
<div class="highlight"><pre><span></span><code>$ git checkout 56b1732
Note: checking out <span class="s1">&#39;56b1732&#39;</span>.

You are in <span class="s1">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
<span class="k">do</span> so <span class="o">(</span>now or later<span class="o">)</span> by using -b with the checkout <span class="nb">command</span> again. Example:

  git checkout -b &lt;new-branch-name&gt;

HEAD is now at 56b1732 <span class="m">1</span> in master
$ cat t1.text 
<span class="m">111</span>
$ git log --oneline
56b1732 <span class="o">(</span>HEAD<span class="o">)</span> <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732 (HEAD detached)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>What happen if we commit current WA</h3>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;111???&quot;</span> &gt;&gt;t1.text
$ git commit -m <span class="s2">&quot;4 in new1&quot;</span> -a
<span class="o">[</span>detached HEAD cef991e<span class="o">]</span> <span class="m">4</span> in new1
 <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>
$ git log --oneline
cef991e <span class="o">(</span>HEAD<span class="o">)</span> <span class="m">4</span> in new1
56b1732 <span class="m">1</span> in master
$ git branch
* <span class="o">(</span>HEAD detached from 56b1732<span class="o">)</span>
  master
  new1
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N(HEAD detached)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left">41e433e</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">fa1cd19 (HEAD -&gt; new1)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">cef991e (HEAD)</td>
</tr>
</tbody>
</table>
<p>It seems we have nothing lost from other branches</p>
<div class="highlight"><pre><span></span><code>$ git checkout new1
Warning: you are leaving <span class="m">1</span> commit behind, not connected to
any of your branches:

  cef991e <span class="m">4</span> in new1

If you want to keep it by creating a new branch, this may be a good <span class="nb">time</span>
to <span class="k">do</span> so with:

 git branch &lt;new-branch-name&gt; cef991e

Switched to branch <span class="s1">&#39;new1&#39;</span>
$ git log --oneline
fa1cd19 <span class="o">(</span>HEAD -&gt; new1<span class="o">)</span> <span class="m">3</span> in new1
41e433e <span class="o">(</span>master<span class="o">)</span> <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
$ git branch
  master
* new1
</code></pre></div>


<h3>Saving detached HEAD in a new branch</h3>
<div class="highlight"><pre><span></span><code>$ git checkout cef991e
Note: checking out <span class="s1">&#39;cef991e&#39;</span>.

You are in <span class="s1">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
<span class="k">do</span> so <span class="o">(</span>now or later<span class="o">)</span> by using -b with the checkout <span class="nb">command</span> again. Example:

  git checkout -b &lt;new-branch-name&gt;

HEAD is now at cef991e <span class="m">4</span> in new1
$ git branch
* <span class="o">(</span>HEAD detached at cef991e<span class="o">)</span>
  master
  new1
$ cat t1.text 
<span class="m">111</span>
<span class="m">111</span>???
$ git branch new2
$ git branch
* <span class="o">(</span>HEAD detached at cef991e<span class="o">)</span>
  master
  new1
  new2
$ git checkout new2
Switched to branch <span class="s1">&#39;new2&#39;</span>
$ git log --oneline
cef991e <span class="o">(</span>HEAD -&gt; new2<span class="o">)</span> <span class="m">4</span> in new1
56b1732 <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch 3(new2)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e (HEAD -&gt; master)</td>
<td align="left">41e433e</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">fa1cd19 (HEAD -&gt; new1)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">cef991e (HEAD -&gt; new2)</td>
</tr>
</tbody>
</table>
<p>Remove branch new2</p>
<p>$ git checkout new1
Switched to branch 'new1'
$ git branch -d new2
$ git log --oneline
fa1cd19 (HEAD -&gt; new1) 3 in new1
41e433e (master) 2 in master
56b1732 1 in master</p>
<h3>Adding new files in current branch</h3>
<div class="highlight"><pre><span></span><code>$ git branch
  master
* new1
$ git log --oneline
fa1cd19 <span class="o">(</span>HEAD -&gt; new1<span class="o">)</span> <span class="m">3</span> in new1
41e433e <span class="o">(</span>master<span class="o">)</span> <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
$ ls
t1.text
$ cat t1.text 
<span class="m">111</span>
<span class="m">222</span>
<span class="m">333</span>
$ <span class="nb">echo</span> <span class="s2">&quot;111&quot;</span>&gt;&gt;t2.txt
$ git add .
$ git commit -m <span class="s2">&quot;new file t2&quot;</span>
<span class="o">[</span>new1 87fe783<span class="o">]</span> new file t2
 <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>
 create mode <span class="m">100644</span> t2.txt
$ git log --oneline
87fe783 <span class="o">(</span>HEAD -&gt; new1<span class="o">)</span> new file t2
fa1cd19 <span class="m">3</span> in new1
41e433e <span class="o">(</span>master<span class="o">)</span> <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
</code></pre></div>


<p>Here we an illustrate the LR as below:</p>
<div class="highlight"><pre><span></span><code><span class="err">|Branch1(master)|Branch2(new1)|Branch N|</span>
</code></pre></div>


<p>---|---|---|---
Commit |56b1732 |56b1732
Commit |41e433e (HEAD -&gt; master)|41e433e
Commit||fa1cd19
Commit||87fe783 (HEAD -&gt; new1)</p>
<h3>Going back to master and move new file to it</h3>
<div class="highlight"><pre><span></span><code>$ git checkout master
Switched to branch <span class="s1">&#39;master&#39;</span>
$ ls
t1.text
$ cat t1.text 
<span class="m">111</span>
<span class="m">222</span>
$ git reset new1
Unstaged changes after reset:
M   t1.text
D   t2.txt
$ git checkout t2.txt
$ ls
t1.text t2.txt
$ git log --oneline
87fe783 <span class="o">(</span>HEAD -&gt; master, new1<span class="o">)</span> new file t2
fa1cd19 <span class="m">3</span> in new1
41e433e <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
$ git branch
* master
  new1
$ cat t1.text 
<span class="m">111</span>
<span class="m">222</span>
$ git status
On branch master
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>

    modified:   t1.text

no changes added to commit <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> and/or <span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
$ git add .
$ git status
On branch master
Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

    modified:   t1.text


$ git commit -m <span class="s2">&quot;new file t2 in master&quot;</span>
<span class="o">[</span>master <span class="m">9218660</span><span class="o">]</span> new file t2 in master
 <span class="m">1</span> file changed, <span class="m">1</span> deletion<span class="o">(</span>-<span class="o">)</span>
$ git log --oneline
<span class="m">9218660</span> <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> new file t2 in master
87fe783 <span class="o">(</span>new1<span class="o">)</span> new file t2
fa1cd19 <span class="m">3</span> in new1
41e433e <span class="m">2</span> in master
56b1732 <span class="m">1</span> in master
</code></pre></div>


<p><code>t2.txt</code> is right now in master, but <code>t1.txt</code> stay no change.
We can also merge changes in <code>t1.txt</code> from branch <code>new1</code>. It is not realted to moving pointer, so I don't talk here. </p>
<p>Here we an illustrate the LR as below:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e</td>
<td align="left">41e433e</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">fa1cd19</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">87fe783 (HEAD -&gt; new1)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">9218660 (HEAD -&gt; master)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3>What if we pull an unrelated RR here?</h3>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="n">ls</span> <span class="p">.</span><span class="n">git</span>
<span class="n">COMMIT_EDITMSG</span>  <span class="n">ORIG_HEAD</span>   <span class="n">config</span>      <span class="n">hooks</span>       <span class="n">info</span>        <span class="n">objects</span>
<span class="n">HEAD</span>        <span class="n">branches</span>    <span class="n">description</span> <span class="n">index</span>       <span class="n">logs</span>        <span class="n">refs</span>

<span class="err">$</span> <span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">xxx</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//github.com/testers-tricks/testers-tricks.github.io</span>
<span class="err">$</span> <span class="n">ls</span> <span class="p">.</span><span class="n">git</span>
<span class="n">COMMIT_EDITMSG</span>  <span class="n">ORIG_HEAD</span>   <span class="n">config</span>      <span class="n">hooks</span>       <span class="n">info</span>        <span class="n">objects</span>
<span class="n">HEAD</span>        <span class="n">branches</span>    <span class="n">description</span> <span class="n">index</span>       <span class="n">logs</span>        <span class="n">refs</span>

<span class="err">$</span> <span class="n">git</span> <span class="n">pull</span> <span class="n">xxx</span>
<span class="nl">warning</span><span class="p">:</span> <span class="n">no</span> <span class="n">common</span> <span class="n">commits</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">15</span><span class="o">/</span><span class="mi">15</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Total</span> <span class="mi">15</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">1</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">9</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">1</span><span class="p">),</span> <span class="n">pack</span><span class="o">-</span><span class="n">reused</span> <span class="mi">0</span>
<span class="n">Unpacking</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">15</span><span class="o">/</span><span class="mi">15</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">From</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//github.com/testers-tricks/testers-tricks.github.io</span>
 <span class="o">*</span> <span class="p">[</span><span class="n">new</span> <span class="n">branch</span><span class="p">]</span>      <span class="n">master</span>     <span class="o">-&gt;</span> <span class="n">xxx</span><span class="o">/</span><span class="n">master</span>
<span class="n">You</span> <span class="n">asked</span> <span class="n">to</span> <span class="n">pull</span> <span class="n">from</span> <span class="n">the</span> <span class="n">remote</span> <span class="err">&#39;</span><span class="n">xxx</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">did</span> <span class="n">not</span> <span class="n">specify</span>
<span class="n">a</span> <span class="n">branch</span><span class="p">.</span> <span class="n">Because</span> <span class="n">this</span> <span class="n">is</span> <span class="n">not</span> <span class="n">the</span> <span class="k">default</span> <span class="n">configured</span> <span class="n">remote</span>
<span class="k">for</span> <span class="n">your</span> <span class="n">current</span> <span class="n">branch</span><span class="p">,</span> <span class="n">you</span> <span class="n">must</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">branch</span> <span class="n">on</span> <span class="n">the</span> <span class="n">command</span> <span class="n">line</span><span class="p">.</span>
<span class="p">(</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">t1</span><span class="p">.</span><span class="n">text</span> <span class="n">t2</span><span class="p">.</span><span class="n">txt</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">branch</span>
<span class="o">*</span> <span class="n">master</span>
  <span class="n">new1</span>
<span class="err">$</span> <span class="n">ls</span> <span class="p">.</span><span class="n">git</span>
<span class="n">COMMIT_EDITMSG</span>  <span class="n">HEAD</span>        <span class="n">branches</span>    <span class="n">description</span> <span class="n">index</span>       <span class="n">logs</span>        <span class="n">refs</span>
<span class="n">FETCH_HEAD</span>  <span class="n">ORIG_HEAD</span>   <span class="n">config</span>      <span class="n">hooks</span>       <span class="n">info</span>        <span class="n">objects</span>
</code></pre></div>


<p>There is no new branch, but a two new heads, named FETCH_HEAD and ORIG_HEAD. </p>
<div class="highlight"><pre><span></span><code>$ git checkout FETCH_HEAD
Note: checking out <span class="s1">&#39;FETCH_HEAD&#39;</span>.

You are in <span class="s1">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
<span class="k">do</span> so <span class="o">(</span>now or later<span class="o">)</span> by using -b with the checkout <span class="nb">command</span> again. Example:

  git checkout -b &lt;new-branch-name&gt;

HEAD is now at a47ef20 merge <span class="nb">test</span>
$ ls
README.en.md    README.md   index.html
$ git branch
* <span class="o">(</span>HEAD detached at FETCH_HEAD<span class="o">)</span>
  master
  new1
$ git status
HEAD detached at FETCH_HEAD
nothing to commit, working tree clean
$ git log --oneline
a47ef20 <span class="o">(</span>HEAD, xxx/master<span class="o">)</span> merge <span class="nb">test</span>
78a7f21 Initial commit
77d03d4 Create index.html
<span class="m">5159440</span> Initial commit
7a16d16 Initial commit
</code></pre></div>


<p>All the historical commits from RR are here. Then we can move the index and checkout file we need or merge it and commit.</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Branch1(master)</th>
<th align="left">Branch2(new1)</th>
<th align="left">Branch N(detached HEAD)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Commit</td>
<td align="left">56b1732</td>
<td align="left">56b1732</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">41e433e</td>
<td align="left">41e433e</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">fa1cd19</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left">87fe783 (HEAD -&gt; new1)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left">9218660 (HEAD -&gt; master)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">7a16d16</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">5159440</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">77d03d4</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">78a7f21</td>
</tr>
<tr>
<td align="left">Commit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">a47ef20(HEAD, xxx/master)</td>
</tr>
</tbody>
</table>
<h2>Staging Area</h2>
<p>We can survive without using SA. Then go back to the questions mentioned above.</p>
<h3>Why I can't put something only in SA and get it back to WA, before <code>git commit</code></h3>
<p>Actually we can, but seledom use.  <code>git add</code> actually add files to SA, which working like cache. <code>git rm --cache</code> removes file from SA. <code>git rm</code> will also delete file pysically from WA.</p>
<p>Let's work only in master brach here to understand SA</p>
<div class="highlight"><pre><span></span><code>$ git branch -v
* <span class="o">(</span>HEAD detached at FETCH_HEAD<span class="o">)</span> a47ef20 merge <span class="nb">test</span>
  master                        <span class="m">9218660</span> new file t2 in master
  new1                          87fe783 new file t2
$ git branch master
fatal: A branch named <span class="s1">&#39;master&#39;</span> already exists.
$ git checkout HEAD
$ ls
README.en.md    README.md   index.html
$ git checkout ORIG_HEAD
Previous HEAD position was a47ef20 merge <span class="nb">test</span>
HEAD is now at <span class="m">9218660</span> new file t2 in master
$ ls
t1.text t2.txt
$ cat t1.text 
<span class="m">111</span>
<span class="m">222</span>
$ cat t2.txt 
<span class="m">111</span>
</code></pre></div>


<p>Making some changes to file t2.txt and commit it to LR</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;222&quot;</span> &gt;&gt;t2.txt 
$ git add t2.txt 
$ git commit -m <span class="s2">&quot;Change something in t2&quot;</span>
<span class="o">[</span>detached HEAD 16ae937<span class="o">]</span> Change something in t2
 <span class="m">1</span> file changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>
$ git status
HEAD detached from ORIG_HEAD
nothing to commit, working tree clean
$ git show
commit 16ae93745f7f7cf2db80d8046e0f550723e88921 <span class="o">(</span>HEAD<span class="o">)</span>
Author: Tao Tao &lt;tao_tao@apple.com&gt;
Date:   Tue Jul <span class="m">16</span> <span class="m">21</span>:01:40 <span class="m">2019</span> +0800

    Change something in t2

diff --git a/t2.txt b/t2.txt
index 58c9bdf..a30a52a <span class="m">100644</span>
--- a/t2.txt
+++ b/t2.txt
@@ -1 +1,2 @@
 <span class="m">111</span>
+222
</code></pre></div>


<p>Making some changes again to file t2.txt, only do <code>git add</code> to cache it in SA.  </p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;333&quot;</span> &gt;&gt;t2.txt 
$ git add t2.txt
</code></pre></div>


<p>Making more changes to file t2.txt, then we check what t2.txt looks like in different areas.</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s2">&quot;444&quot;</span> &gt;&gt;t2.txt
</code></pre></div>


<p>In WA, it has the most recent line "444".<br>
    $ cat t2.txt 
    111
    222
    333
    444</p>
<p><code>git diff</code> compares WA on top of SA. </p>
<div class="highlight"><pre><span></span><code>$ git diff
diff --git a/t2.txt b/t2.txt
index 641d574..337d413 <span class="m">100644</span>
--- a/t2.txt
+++ b/t2.txt
@@ -1,3 +1,4 @@
 <span class="m">111</span>
 <span class="m">222</span>
 <span class="m">333</span>
+444
</code></pre></div>


<p><code>git diff --cached</code> or <code>git diff --staged</code> compares SA on top of Current HEAD in LR. </p>
<div class="highlight"><pre><span></span><code>$ git diff --cached
diff --git a/t2.txt b/t2.txt
index a30a52a..641d574 <span class="m">100644</span>
--- a/t2.txt
+++ b/t2.txt
@@ -1,2 +1,3 @@
 <span class="m">111</span>
 <span class="m">222</span>
+333
</code></pre></div>


<p><code>git diff HEAD</code> compares WA on top of current HEAD in LR.</p>
<div class="highlight"><pre><span></span><code>$ git diff HEAD
diff --git a/t2.txt b/t2.txt
index a30a52a..337d413 <span class="m">100644</span>
--- a/t2.txt
+++ b/t2.txt
@@ -1,2 +1,4 @@
 <span class="m">111</span>
 <span class="m">222</span>
+333
+444
</code></pre></div>


<p>If we always quickly use <code>git add</code>,<code>git commit</code> together. Staging Area seems transparent and useless. We can just use <code>git diff HEAD</code> for difference. </p>
<h3>Why <code>git checkout</code> means from SA, <code>git checkout HEAD</code> means from LR</h3>
<p>Similarly, <code>git checkout</code> is actually checkout files from SA. If we don't care about SA, <code>git checkout HEAD</code> works just like how we have used <code>git diff HEAD</code>, checking out files from LR to WA.</p>
<p><img alt="" src="./pictures/use of diff&amp;checkout.jpg"></p>
<p>It is wrong if you think of <code>git checkout --cached</code> as checkout from HEAD in LR to SA. Instead <code>git reset</code> does this job. <code>git checkout</code> always default targeting at WA.</p>
<h1>Here is my cheatsheet with demoted Staging operations</h1>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Working Area (WA)</th>
<th align="left">Local Repository(LR)</th>
<th align="left">Remote Repository(RR)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Working Area</td>
<td align="left">mkdir,git init;git status</td>
<td align="left">git commit</td>
<td align="left">No way to send directly from WA</td>
</tr>
<tr>
<td align="left">Local Repository</td>
<td align="left">git checkout HEAD; git merge</td>
<td align="left">git branch;git reset;git log</td>
<td align="left">git push</td>
</tr>
<tr>
<td align="left">Remote Repository</td>
<td align="left">git pull,git clone</td>
<td align="left">git fetch</td>
<td align="left">operate in remote system/web</td>
</tr>
</tbody>
</table>
<p><img alt="MyCheatsheet" src="./pictures/Git cheatsheet.png"></p>
            <div>
</div>

            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2019-07-10T10:00:00+08:00">Jul 10, 2019</time>

<h4>Last Updated</h4>
<time datetime="2019-07-15T00:00:00+08:00">Jul 15, 2019</time>

            <h4>Category</h4>
            <a class="category-link" href="/categories.html#bears-corncobs-ref">Bear's Corncobs</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags#git-ref">git
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="https://github.com/Pelican-Elegant/elegant/" title="Theme Elegant Home Page">Elegant</a></li>
    </ul>
</div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : MIT -->
</html>